techs:
  pumped_hydro:  # from [@schmidt:2019] Table S4
    name: 'Pumped hydro power storage'
    base_tech: storage
    carrier_in: electricity
    carrier_out: electricity
    flow_cap_max: inf
    storage_cap_max: inf
    flow_in_eff: 0.8832
    flow_out_eff: 0.8832 # 0.78 round-trip
    lifetime: 55
    cost_storage_cap:
      data: {{ 72133 * 1.02 * scaling_factors.specific_costs }} # {{ (1 / scaling_factors.specific_costs) | unit("EUR2015/MWh") }}, 80 $2015
      index: monetary
      dims: costs
    cost_flow_cap:
      data: {{ 1017973 * 1.02 * scaling_factors.specific_costs }} # {{ (1 / scaling_factors.specific_costs) | unit("EUR2015/MW") }}, 1129 $2015
      index: monetary
      dims: costs
    cost_om_annual:
      data: {{ 7213 * 1.02 * scaling_factors.specific_costs }} # {{ (1 / scaling_factors.specific_costs) | unit("EUR2015/MW/year") }}, 8 $2015
      index: monetary
      dims: costs
    cost_flow_out:
      data: {{ 1 * 1.02 * scaling_factors.specific_costs }} # {{ (1 / scaling_factors.specific_costs) | unit("EUR2015/MWh") }}, 1 $2015, rounded to 1â‚¬ for numeric range
      index: monetary
      dims: costs

overrides:
  no-hydro-storage-fixed-cost:
    # Only assign costs to O&M and variable costs
    techs.pumped_hydro:
      cost_storage_cap:
        data: 0
        index: monetary
        dims: costs
      cost_flow_cap:
        data: 0
        index: monetary
        dims: costs
  freeze-hydro-storage-capacities:
    nodes:
      {% for id, location in locations.iterrows() %}
      {{ id }}.techs:
        pumped_hydro:
          flow_cap_min: {{ location.installed_capacity_hphs_MW * scaling_factors.power }} # {{ (1 / scaling_factors.power) | unit("MW") }}
          flow_cap_max: {{ location.installed_capacity_hphs_MW * scaling_factors.power }} # {{ (1 / scaling_factors.power) | unit("MW") }}
          storage_cap_min: {{ location.storage_capacity_hphs_MWh * scaling_factors.power }} # {{ (1 / scaling_factors.power) | unit("MWh") }}
          storage_cap_max: {{ location.storage_capacity_hphs_MWh * scaling_factors.power }} # {{ (1 / scaling_factors.power) | unit("MWh") }}
      {% endfor %}

nodes:
  {% for id, location in locations.iterrows() %}
  {{ id }}.techs:
    pumped_hydro:
      flow_cap_max: {{ location.installed_capacity_hphs_MW * scaling_factors.power }} # {{ (1 / scaling_factors.power) | unit("MW") }}
      storage_cap_max: {{ location.storage_capacity_hphs_MWh * scaling_factors.power }} # {{ (1 / scaling_factors.power) | unit("MWh") }}
  {% endfor %}
