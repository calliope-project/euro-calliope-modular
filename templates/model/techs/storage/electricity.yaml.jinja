techs:
  battery:  # from [@schmidt:2019] Table S4
    name: 'Battery storage'
    base_tech: storage
    carrier_in: electricity
    carrier_out: electricity
    flow_cap_max: .inf
    storage_cap_max: .inf
    flow_in_eff: 0.9273
    flow_out_eff: 0.9273  # 0.86 round trip efficiency
    storage_loss: 0  # No loss over time assumed
    lifetime: 10
    cost_storage_cap:
      data: {{ 723130 * 0.14 * scaling_factors.specific_costs }} # {{ (1 / scaling_factors.specific_costs) | unit("EUR2015/MWh") }}, 802 $2015
      index: monetary
      dims: costs
    cost_flow_cap:
      data: {{ 611324 * 0.14 * scaling_factors.specific_costs }} # {{ (1 / scaling_factors.specific_costs) | unit("EUR2015/MW") }}, 678 $2015
      index: monetary
      dims: costs
    cost_om_annual:
      data: {{ 9016 * 0.14 * scaling_factors.specific_costs }} # {{ (1 / scaling_factors.specific_costs) | unit("EUR2015/MW/year") }}, 10 $2015
      index: monetary
      dims: costs
    cost_flow_out:
      data: {{ 2.7 * 0.14 * scaling_factors.specific_costs }} # {{ (1 / scaling_factors.specific_costs) | unit("EUR2015/MWh") }}, 3 $2015
      index: monetary
      dims: costs

  hydrogen:  # from [@schmidt:2019] Table S4
    name: Hydrogen power storage
    base_tech: storage
    carrier_in: electricity
    carrier_out: electricity
    flow_cap_max: .inf
    storage_cap_max: .inf
    flow_in_eff: 0.6325  # 0.40 round-trip
    flow_out_eff: 0.6325
    lifetime: 15
    cost_storage_cap:
      data: {{ 27951 * 0.33 * scaling_factors.specific_costs }}  # {{ (1 / scaling_factors.specific_costs) | unit("EUR2015/MWh") }}, 31 $2015
      index: monetary
      dims: costs
    cost_flow_cap:
      data: {{ 4884287 * 0.33 * scaling_factors.specific_costs }}  # {{ (1 / scaling_factors.specific_costs) | unit("EUR2015/MW") }}, 5417 $2015
      index: monetary
      dims: costs
    cost_om_annual:
      data: {{ 41476 * 0.33 * scaling_factors.specific_costs }} # {{ (1 / scaling_factors.specific_costs) | unit("EUR2015/MW/year") }}, 46 $2015
      index: monetary
      dims: costs
    cost_flow_out:
      data: 0
      index: monetary
      dims: costs

overrides:
  exclusive-energy-to-power-ratios:
    # Ensures exclusive energy to power ratios of battery (≤4h) and hydrogen (≥4h) storage.
    techs:
      battery.flow_cap_per_storage_cap_min: 0.25 # ≤ 4h full-power discharge
      hydrogen.flow_cap_per_storage_cap_max: 0.25 # ≥ 4h full-power discharge


nodes:
  {% for id, location in locations.iterrows() %}
  {{ id }}.techs:
    battery:
    hydrogen:
  {% endfor %}
